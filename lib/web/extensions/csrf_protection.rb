module Sinatra
  module Wpxf
    module CsrfProtection
      def use_csrf_protection(opts = nil)
        return unless settings.enable_csrf_protection
        if opts
          use Rack::Csrf, opts
        else
          use Rack::Csrf
        end
      end
    end
  end

  register Wpxf::CsrfProtection
end
