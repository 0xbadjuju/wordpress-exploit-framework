var controllers = angular.module('controllers', []);

controllers.controller('ModulesCtrl', function ($scope, $routeParams, $http, $location) {
  $scope.$on('dataTableRendered', function(e) {
    $('.datatable').DataTable({ 'pageLength': 25 });
  });

  $scope.loadModule = function(path) {
    $location.path('/module/' + path);
  };

  $http.get('/api/modules/list/' + $routeParams.moduleType)
    .then(function (resp) {
      $scope.modules = resp.data;
    });
});

controllers.controller('ModuleCtrl', function ($scope, $routeParams, $http, $location) {
  var moduleApi = Kiwi.compose('/api/module/%{moduleType}/%{moduleName}', $routeParams);
  $http.get(moduleApi).then(function (resp) {
    $scope.module = resp.data;
    $scope.module.is_exploit = $routeParams.moduleType == 'exploit';
  });

  $http.get('/api/payloads').then(function (resp) {
    $scope.payloads = resp.data;
  });
});
