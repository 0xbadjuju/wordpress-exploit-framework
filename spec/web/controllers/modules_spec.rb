require_relative '../../spec_helper'

describe Web::Controllers::Modules do
  let(:app) { described_class }

  it_behaves_like 'a route controller'

  describe 'GET /list/:type' do
    it 'returns all modules for the specified namespace' do
      get '/list/auxiliary'

      JSON.parse(last_response.body).each do |i|
        expect(i).to include(
          'path',
          'title',
          'desc',
          'date',
          'type',
          'name'
        )
      end
    end

    it 'returns an empty body if :type !== exploit or auxiliary' do
      get '/list/invalid'
      expect(last_response.body).to eq ''
    end
  end
end
